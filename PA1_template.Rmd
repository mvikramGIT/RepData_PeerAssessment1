---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
dt <- read.csv("activity.csv", header = TRUE, stringsAsFactors = FALSE)
dt$date <- as.Date(dt$date, "%Y-%m-%d")
head(dt)
```

## What is mean total number of steps taken per day?
```{r}
a <- aggregate(steps ~ date, dt, sum)
hist(a$steps, xlab = "Steps", main = "Histogram of Steps in a day", col = "Red")
     ```

The average steps taken per day is 
```{r} 
mean(a$steps)
``` 
and the median is 
```{r}
median(a$steps)
```

## What is the average daily activity pattern?
```{r}
a <- aggregate(steps ~ interval, dt, mean)
plot(a$interval, a$steps, type = 'l', xlab = "Interval", ylab = "Mean steps")
```

The interval with maximum average number of steps across days is as follows.
```{r}
a$interval[a$steps == max(a$steps)]
```

## Inputing missing values

The total number of missing steps data is calculated to be:
```{r}
sum(is.na(dt$steps))
```
To estimate the missing values, we use that intervals average across days.
```{r}
dt[is.na(dt$steps),]$steps <- a$steps[dt[is.na(dt$steps),]$interval == a$interval]
a <- aggregate(steps ~ date, dt, sum)
hist(a$steps, xlab = "Steps", main = "Histogram of Steps in a day", col = "Red")
```
Evaluating mean and median again:

The average steps taken per day is 
```{r} 
mean(a$steps)
``` 
and the median is 
```{r}
median(a$steps)
```
The filling in of data has not affected the mean and medium significantly.

## Are there differences in activity patterns between weekdays and weekends?
```{r}
wknd  <- weekdays(dt$date)=="Saturday"|weekdays(dt$date)=="Sunday"
dt$dow[wknd] <- "Weekend"
dt$dow[!wknd] <- "Weekday"
dt$dow <- as.factor(dt$dow)
library(lattice)
xyplot(steps~interval | dow, data = dt, layout = c(1,2), type = 'l')
```